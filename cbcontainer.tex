\section{Introduction}

This is a security report created from your Kubernetes clusters protect by Carbon Black Container.

\section{Kubernetes clusters}

This is the list of Kubernetes clusters protected by Carbon Black Container.

\subsection{Kubernetes Clusters list}
\verbfile{./cluster_list.txt}

\subsection{Kubernetes Clusters diff}
This is the diff of new or removed Kubernetes clusters since last report:
\vskip10pt
\input{clusterlistdiff}

\section{Namespaces}

This is the list of \gls{ns} protected by Carbon Black Container.

\subsection{Namespaces list}
\verbfile{./namespace_list.txt}

\subsection{Namespaces list diff}
This is the list of new or removed namespaces since last report:
\vskip10pt
\input{namespacelistdiff}

\section{Container Registries}
\subsection{Container Registries list}
This is the list of container Registries detected by Carbon Black Container.
\vskip15pt

\verbfile{./registry_list.txt}

\vskip15pt

\subsection{Container Registries diff}
This is the diff of new or removed container Registries since last report:
\vskip10pt
%\verbfile{./registry_list_diff.txt}
\input{registrylistdiff}

\section{Hardening Policies}

This section list all security policies, and provides the number of exceptions and violations.

\input{hardeningpolicies}

\begin{importantblock}
	Violations can be: alert or block or \gls{enforcement}. Modify your infrastructure to be compliant, and last option can be to add some exceptions.
\end{importantblock}

\section{Security alerts}

Carbon Black container provides 3 types of alerts:
\begin{enumerate}
  \item Containers Runtime alerts
  \item CB Analytics (Antivirus)
  \item Watchlists (IOCs: Feeds and custom Watchlists)
\end{enumerate}

\subsection{Containers Runtime alerts - Network}
\noindent

\input{runtimealert}
\vskip10pt

This is the list of Runtime security alerts, for more details, please see Carbon Black console.
\vskip10pt

\input{alertreason}

\begin{tipblock}
	Alerts can be reduced by increasing training period (1, 2, 7 days) or by restarting the training after a new deployment.
\end{tipblock}

\begin{importantblock}
	Port scan and malicious reputation should be investigated.
\end{importantblock}

\vskip10pt
\input{alertsremoteip}

\vskip10pt
\input{alertsnamespace}

\subsection{CB Analytics (NGAV - Next Gen Anti Virus)}
This section lists all virus detected at Runtime, in a container image or on the Linux node.

\subsection{Watchlists (EEDR - Enterprise Endpoint Detection and Response)}
This section lists all IOCs detected at Runtime, in a container image or on the Linux node.


\section{Malware and Secret Detection}
This section lists all virus and secrets detected in container images.

\input{malware}

\section{Vulnerabilities}
There's always vulnerabilities in all software.\\
The goal is to minimize the critical vulnerabilities (in Dark red)!

\newtcbox{\criticalvulncbox}{colframe=VCRITICAL,colback=VCRITICAL,top=0pt,bottom=0pt,colupper=white}
\newtcbox{\highvulncbox}{colframe=VHIGH,colback=VHIGH,top=0pt,bottom=0pt,colupper=white}
\newtcbox{\mediumvulncbox}{colframe=VMEDIUM,colback=VMEDIUM,top=0pt,bottom=0pt,colupper=white}
\newtcbox{\lowvulncbox}{colframe=VLOW,colback=VLOW,top=0pt,bottom=0pt}
\newtcbox{\unknownvulncbox}{colframe=VUNKNOWN,colback=VUNKNOWN,top=0pt,bottom=0pt,colupper=white}


\subsection{Vulnerabilities overview}
This is an overview of vulnerabilities in container images running in your Kubernetes cluster:

\input{vulnoverview}

%\subsection{Vulnerabilities histogram}
% \input{histo}]

\subsection{Critical vulnerabilities}
Only container images with critical vulnerabilities will be listed below.


\vskip10pt

\tcbset{on line}
Color code:
\criticalvulncbox{Critical}
\highvulncbox{High}
\mediumvulncbox{Medium} 
\lowvulncbox{Low} 
\unknownvulncbox{Unknown} 

Example: 
\criticalvulncbox{200/100} = 
200 critical vulnerabilities / 100 critical vulnerabilities with a fix available.
\par

\begin{center}
\rule{0.5\linewidth}{1pt}
\end{center}

\input{critical}

